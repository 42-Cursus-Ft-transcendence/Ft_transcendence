
services:

  anvil:
    image: ghcr.io/foundry-rs/foundry:latest
    entrypoint:
      - anvil
      - --host
      - 0.0.0.0
      - --chain-id
      - "31337"
      - --port
      - "8545"
    ports:
      - "8545:8545"
    networks:
      - pongnet

  backend:
    build:
      context: ../..                  
      dockerfile: src/docker/Dockerfile
      target: runtime
    depends_on:
      - anvil
    env_file:
      - ./.env.backend
    networks:
      - pongnet      # <-- no colon here

  nginx:
    build:
      context: ../..              
      dockerfile: src/docker/nginx/Dockerfile
    container_name: nginx
    depends_on:
      - backend
    ports:
      - "8080:80"
      - "8443:443"
    networks:
      - pongnet

# Define the network
networks:
  pongnet:
    driver: bridge
